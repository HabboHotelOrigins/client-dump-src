property pBgSprite, pUserSprite, pLocation, pTextParams, pBalloonImg, pBgMemName, pItemId, pMargins, tVariations, pUserName, pUserId, pSourceLocation, pBalloonLeftMarg, pBalloonRightMarg

on construct me
  [  0] pusharglist 0 ........................... <>
  [  2] extcall 118 ............................. <VOID>
  [  4] setprop 1258 ............................ pItemId = VOID
  [  7] getparam 0 .............................. <me>
  [  9] pusharglist 1 ........................... <me>
  [ 11] objcall 89 .............................. <me.getID()>
  [ 13] pusharglist 1 ........................... <me.getID()>
  [ 15] extcall 301 ............................. <reserveSprite(me.getID())>
  [ 18] pusharglist 1 ........................... <reserveSprite(me.getID())>
  [ 20] extcall 300 ............................. <sprite(reserveSprite(me.getID()))>
  [ 23] setprop 1259 ............................ pBgSprite = sprite(reserveSprite(me.getID()))
  [ 26] getparam 0 .............................. <me>
  [ 28] pusharglist 1 ........................... <me>
  [ 30] objcall 89 .............................. <me.getID()>
  [ 32] pusharglist 1 ........................... <me.getID()>
  [ 34] extcall 301 ............................. <reserveSprite(me.getID())>
  [ 37] pusharglist 1 ........................... <reserveSprite(me.getID())>
  [ 39] extcall 300 ............................. <sprite(reserveSprite(me.getID()))>
  [ 42] setprop 1260 ............................ pUserSprite = sprite(reserveSprite(me.getID()))
  [ 45] pushcons 0 .............................. <EMPTY>
  [ 47] setprop 1261 ............................ pUserName = EMPTY
  [ 50] pushcons 0 .............................. <EMPTY>
  [ 52] setprop 320 ............................. pUserId = EMPTY
  [ 55] pusharglist 0 ........................... <>
  [ 57] extcall 118 ............................. <VOID>
  [ 59] setprop 1262 ............................ pSourceLocation = VOID
  [ 62] pusharglist 0 ........................... <[:]>
  [ 64] pushproplist ............................ <[:]>
  [ 65] setprop 1263 ............................ pMargins = [:]
  [ 68] getprop 1263 ............................ <pMargins>
  [ 71] pushsymb 695 ............................ <#left>
  [ 74] pushint8 5 .............................. <5>
  [ 76] pusharglistnoret 3 ...................... <pMargins, #left, 5>
  [ 78] objcall 73 .............................. pMargins[#left] = 5
  [ 80] getprop 1263 ............................ <pMargins>
  [ 83] pushsymb 229 ............................ <#right>
  [ 85] pushint8 6 .............................. <6>
  [ 87] pusharglistnoret 3 ...................... <pMargins, #right, 6>
  [ 89] objcall 73 .............................. pMargins[#right] = 6
  [ 91] getprop 1263 ............................ <pMargins>
  [ 94] pushsymb 1264 ........................... <#textleft>
  [ 97] pushint8 30 ............................. <30>
  [ 99] pusharglistnoret 3 ...................... <pMargins, #textleft, 30>
  [101] objcall 73 .............................. pMargins[#textleft] = 30
  [103] pushcons 0 .............................. <EMPTY>
  [105] setprop 1265 ............................ pBgMemName = EMPTY
  [108] pushcons 1 .............................. <"CUSTOM">
  [110] pushcons 2 .............................. <"bold">
  [112] pusharglist 2 ........................... <["CUSTOM": "bold"]>
  [114] pushproplist ............................ <["CUSTOM": "bold"]>
  [115] setprop 1267 ............................ tVariations = ["CUSTOM": "bold"]
  [118] pusharglist 0 ........................... <[:]>
  [120] pushproplist ............................ <[:]>
  [121] setprop 1268 ............................ pTextParams = [:]
  [124] pushint8 1 .............................. <1>
  [126] setlocal 0
  [128] getlocal 0
  [130] getprop 1267 ............................ <tVariations>
  [133] getobjprop 105 .......................... <tVariations.count>
  [135] lteq
  [136] jmpifz [331] ............................ repeat with i = 1 to tVariations.count
  [139] pushcons 3 .............................. <"struct.font.">
  [141] getprop 1267 ............................ <tVariations>
  [144] getlocal 0 .............................. <i>
  [146] pusharglist 2 ........................... <tVariations, i>
  [148] objcall 75 .............................. <tVariations[i]>
  [150] joinstr ................................. <"struct.font." & tVariations[i]>
  [151] pusharglist 1 ........................... <"struct.font." & tVariations[i]>
  [153] extcall 111 ............................. <getStructVariable("struct.font." & tVariations[i])>
  [155] setlocal 1 .............................. tFontStruct = getStructVariable("struct.font." & tVariations[i])
  [157] pushcons 4 .............................. <"balloon.text.">
  [159] getprop 1267 ............................ <tVariations>
  [162] getlocal 0 .............................. <i>
  [164] pusharglist 2 ........................... <tVariations, i>
  [166] objcall 177 ............................. <tVariations.getPropAt(i)>
  [168] joinstr ................................. <"balloon.text." & tVariations.getPropAt(i)>
  [169] setlocal 2 .............................. tMemName = "balloon.text." & tVariations.getPropAt(i)
  [171] getlocal 2 .............................. <tMemName>
  [173] pusharglist 1 ........................... <tMemName>
  [175] extcall 204 ............................. <memberExists(tMemName)>
  [177] not ..................................... <not memberExists(tMemName)>
  [178] jmpifz [200] ............................ if not memberExists(tMemName) then / else
  [181] getlocal 2 .............................. <tMemName>
  [183] pushsymb 646 ............................ <#text>
  [186] pusharglist 2 ........................... <tMemName, #text>
  [188] extcall 645 ............................. <createMember(tMemName, #text)>
  [191] pusharglist 1 ........................... <createMember(tMemName, #text)>
  [193] extcall 134 ............................. <member(createMember(tMemName, #text))>
  [195] setlocal 3 .............................. tmember = member(createMember(tMemName, #text))
  [197] jmp [213]
  [200] getlocal 2 .............................. <tMemName>
  [202] pusharglist 1 ........................... <tMemName>
  [204] extcall 305 ............................. <getmemnum(tMemName)>
  [207] pusharglist 1 ........................... <getmemnum(tMemName)>
  [209] extcall 134 ............................. <member(getmemnum(tMemName))>
  [211] setlocal 3 .............................. tmember = member(getmemnum(tMemName))
  [213] getlocal 3 .............................. <tmember>
  [215] pushzero ................................ <0>
  [216] setobjprop 647 .......................... tmember.wordWrap = 0
  [219] getlocal 3 .............................. <tmember>
  [221] pushsymb 648 ............................ <#adjust>
  [224] setobjprop 649 .......................... tmember.boxType = #adjust
  [227] getlocal 3 .............................. <tmember>
  [229] pushzero ................................ <0>
  [230] setobjprop 650 .......................... tmember.antialias = 0
  [233] getlocal 3 .............................. <tmember>
  [235] getlocal 1 .............................. <tFontStruct>
  [237] pushsymb 651 ............................ <#font>
  [240] pusharglist 2 ........................... <tFontStruct, #font>
  [242] objcall 149 ............................. <tFontStruct.getaProp(#font)>
  [244] setobjprop 651 .......................... tmember.font = tFontStruct.getaProp(#font)
  [247] getlocal 3 .............................. <tmember>
  [249] getlocal 1 .............................. <tFontStruct>
  [251] pushsymb 652 ............................ <#fontSize>
  [254] pusharglist 2 ........................... <tFontStruct, #fontSize>
  [256] objcall 149 ............................. <tFontStruct.getaProp(#fontSize)>
  [258] setobjprop 652 .......................... tmember.fontSize = tFontStruct.getaProp(#fontSize)
  [261] getlocal 3 .............................. <tmember>
  [263] getlocal 1 .............................. <tFontStruct>
  [265] pushsymb 653 ............................ <#fontStyle>
  [268] pusharglist 2 ........................... <tFontStruct, #fontStyle>
  [270] objcall 149 ............................. <tFontStruct.getaProp(#fontStyle)>
  [272] setobjprop 653 .......................... tmember.fontStyle = tFontStruct.getaProp(#fontStyle)
  [275] getprop 1268 ............................ <pTextParams>
  [278] getprop 1267 ............................ <tVariations>
  [281] getlocal 0 .............................. <i>
  [283] pusharglist 2 ........................... <tVariations, i>
  [285] objcall 177 ............................. <tVariations.getPropAt(i)>
  [287] pushsymb 134 ............................ <#member>
  [289] getlocal 3 .............................. <tmember>
  [291] pushsymb 651 ............................ <#font>
  [294] getlocal 1 .............................. <tFontStruct>
  [296] pushsymb 651 ............................ <#font>
  [299] pusharglist 2 ........................... <tFontStruct, #font>
  [301] objcall 149 ............................. <tFontStruct.getaProp(#font)>
  [303] pushsymb 653 ............................ <#fontStyle>
  [306] getlocal 1 .............................. <tFontStruct>
  [308] pushsymb 653 ............................ <#fontStyle>
  [311] pusharglist 2 ........................... <tFontStruct, #fontStyle>
  [313] objcall 149 ............................. <tFontStruct.getaProp(#fontStyle)>
  [315] pusharglist 6 ........................... <[#member: tmember, #font: tFontStruct.getaProp(#font), #fontStyle: tFontStruct.getaProp(#fontStyle)]>
  [317] pushproplist ............................ <[#member: tmember, #font: tFontStruct.getaProp(#font), #fontStyle: tFontStruct.getaProp(#fontStyle)]>
  [318] pusharglistnoret 3 ...................... <pTextParams, tVariations.getPropAt(i), [#member: tmember, #font: tFontStruct.getaProp(#font), #fontStyle: tFontStruct.getaProp(#fontStyle)]>
  [320] objcall 73 .............................. pTextParams[tVariations.getPropAt(i)] = [#member: tmember, #font: tFontStruct.getaProp(#font), #fontStyle: tFontStruct.getaProp(#fontStyle)]
  [322] pushint8 1
  [324] getlocal 0
  [326] add
  [327] setlocal 0
  [329] endrepeat [128]
  [331] pusharglist 0 ........................... <[:]>
  [333] pushproplist ............................ <[:]>
  [334] setprop 1269 ............................ pBalloonImg = [:]
  [337] getprop 1269 ............................ <pBalloonImg>
  [340] pushsymb 695 ............................ <#left>
  [343] pushcons 5 .............................. <"chat_bubble_gold_left">
  [345] pusharglist 1 ........................... <"chat_bubble_gold_left">
  [347] extcall 305 ............................. <getmemnum("chat_bubble_gold_left")>
  [350] pusharglist 1 ........................... <getmemnum("chat_bubble_gold_left")>
  [352] extcall 134 ............................. <member(getmemnum("chat_bubble_gold_left"))>
  [354] getchainedprop 175 ...................... <member(getmemnum("chat_bubble_gold_left")).image>
  [356] pusharglist 1 ........................... <member(getmemnum("chat_bubble_gold_left")).image>
  [358] objcall 176 ............................. <member(getmemnum("chat_bubble_gold_left")).image.duplicate()>
  [360] pusharglistnoret 3 ...................... <pBalloonImg, #left, member(getmemnum("chat_bubble_gold_left")).image.duplicate()>
  [362] objcall 169 ............................. pBalloonImg.addProp(#left, member(getmemnum("chat_bubble_gold_left")).image.duplicate())
  [364] getprop 1269 ............................ <pBalloonImg>
  [367] pushsymb 1270 ........................... <#leftcolor>
  [370] pushcons 6 .............................. <"chat_bubble_left_color">
  [372] pusharglist 1 ........................... <"chat_bubble_left_color">
  [374] extcall 305 ............................. <getmemnum("chat_bubble_left_color")>
  [377] pusharglist 1 ........................... <getmemnum("chat_bubble_left_color")>
  [379] extcall 134 ............................. <member(getmemnum("chat_bubble_left_color"))>
  [381] getchainedprop 175 ...................... <member(getmemnum("chat_bubble_left_color")).image>
  [383] pusharglist 1 ........................... <member(getmemnum("chat_bubble_left_color")).image>
  [385] objcall 176 ............................. <member(getmemnum("chat_bubble_left_color")).image.duplicate()>
  [387] pusharglistnoret 3 ...................... <pBalloonImg, #leftcolor, member(getmemnum("chat_bubble_left_color")).image.duplicate()>
  [389] objcall 169 ............................. pBalloonImg.addProp(#leftcolor, member(getmemnum("chat_bubble_left_color")).image.duplicate())
  [391] getprop 1269 ............................ <pBalloonImg>
  [394] pushsymb 1271 ........................... <#middle>
  [397] pushcons 7 .............................. <"chat_bubble_gold_middle">
  [399] pusharglist 1 ........................... <"chat_bubble_gold_middle">
  [401] extcall 305 ............................. <getmemnum("chat_bubble_gold_middle")>
  [404] pusharglist 1 ........................... <getmemnum("chat_bubble_gold_middle")>
  [406] extcall 134 ............................. <member(getmemnum("chat_bubble_gold_middle"))>
  [408] getchainedprop 175 ...................... <member(getmemnum("chat_bubble_gold_middle")).image>
  [410] pusharglist 1 ........................... <member(getmemnum("chat_bubble_gold_middle")).image>
  [412] objcall 176 ............................. <member(getmemnum("chat_bubble_gold_middle")).image.duplicate()>
  [414] pusharglistnoret 3 ...................... <pBalloonImg, #middle, member(getmemnum("chat_bubble_gold_middle")).image.duplicate()>
  [416] objcall 169 ............................. pBalloonImg.addProp(#middle, member(getmemnum("chat_bubble_gold_middle")).image.duplicate())
  [418] getprop 1269 ............................ <pBalloonImg>
  [421] pushsymb 229 ............................ <#right>
  [423] pushcons 8 .............................. <"chat_bubble_gold_right">
  [425] pusharglist 1 ........................... <"chat_bubble_gold_right">
  [427] extcall 305 ............................. <getmemnum("chat_bubble_gold_right")>
  [430] pusharglist 1 ........................... <getmemnum("chat_bubble_gold_right")>
  [432] extcall 134 ............................. <member(getmemnum("chat_bubble_gold_right"))>
  [434] getchainedprop 175 ...................... <member(getmemnum("chat_bubble_gold_right")).image>
  [436] pusharglist 1 ........................... <member(getmemnum("chat_bubble_gold_right")).image>
  [438] objcall 176 ............................. <member(getmemnum("chat_bubble_gold_right")).image.duplicate()>
  [440] pusharglistnoret 3 ...................... <pBalloonImg, #right, member(getmemnum("chat_bubble_gold_right")).image.duplicate()>
  [442] objcall 169 ............................. pBalloonImg.addProp(#right, member(getmemnum("chat_bubble_gold_right")).image.duplicate())
  [444] getprop 1269 ............................ <pBalloonImg>
  [447] pushsymb 1272 ........................... <#pointer>
  [450] pushcons 9 .............................. <"chat_bubble_pointer">
  [452] pusharglist 1 ........................... <"chat_bubble_pointer">
  [454] extcall 305 ............................. <getmemnum("chat_bubble_pointer")>
  [457] pusharglist 1 ........................... <getmemnum("chat_bubble_pointer")>
  [459] extcall 134 ............................. <member(getmemnum("chat_bubble_pointer"))>
  [461] getchainedprop 175 ...................... <member(getmemnum("chat_bubble_pointer")).image>
  [463] pusharglist 1 ........................... <member(getmemnum("chat_bubble_pointer")).image>
  [465] objcall 176 ............................. <member(getmemnum("chat_bubble_pointer")).image.duplicate()>
  [467] pusharglistnoret 3 ...................... <pBalloonImg, #pointer, member(getmemnum("chat_bubble_pointer")).image.duplicate()>
  [469] objcall 169 ............................. pBalloonImg.addProp(#pointer, member(getmemnum("chat_bubble_pointer")).image.duplicate())
  [471] pushcons 10 ............................. <"balloons.leftmargin">
  [473] pusharglist 1 ........................... <"balloons.leftmargin">
  [475] extcall 478 ............................. <variableExists("balloons.leftmargin")>
  [478] jmpifz [495] ............................ if variableExists("balloons.leftmargin") then / else
  [481] pushcons 10 ............................. <"balloons.leftmargin">
  [483] pushzero ................................ <0>
  [484] pusharglist 2 ........................... <"balloons.leftmargin", 0>
  [486] extcall 326 ............................. <getIntVariable("balloons.leftmargin", 0)>
  [489] setprop 1273 ............................ pBalloonLeftMarg = getIntVariable("balloons.leftmargin", 0)
  [492] jmp [499]
  [495] pushzero ................................ <0>
  [496] setprop 1273 ............................ pBalloonLeftMarg = 0
  [499] pushcons 11 ............................. <"balloons.rightmargin">
  [501] pusharglist 1 ........................... <"balloons.rightmargin">
  [503] extcall 478 ............................. <variableExists("balloons.rightmargin")>
  [506] jmpifz [523] ............................ if variableExists("balloons.rightmargin") then / else
  [509] pushcons 11 ............................. <"balloons.rightmargin">
  [511] pushzero ................................ <0>
  [512] pusharglist 2 ........................... <"balloons.rightmargin", 0>
  [514] extcall 326 ............................. <getIntVariable("balloons.rightmargin", 0)>
  [517] setprop 1274 ............................ pBalloonRightMarg = getIntVariable("balloons.rightmargin", 0)
  [520] jmp [537]
  [523] pusharglist 0 ........................... <>
  [525] thebuiltin 664 .......................... <the stageRight>
  [528] pusharglist 0 ........................... <>
  [530] thebuiltin 998 .......................... <the stageLeft>
  [533] sub ..................................... <the stageRight - the stageLeft>
  [534] setprop 1274 ............................ pBalloonRightMarg = the stageRight - the stageLeft
  [537] ret
end

on deconstruct me
  [  0] getprop 1259 ............................ <pBgSprite>
  [  3] pusharglist 1 ........................... <pBgSprite>
  [  5] extcall 146 ............................. <ilk(pBgSprite)>
  [  7] pushsymb 300 ............................ <#sprite>
  [ 10] eq ...................................... <ilk(pBgSprite) = #sprite>
  [ 11] jmpifz [ 32] ............................ if ilk(pBgSprite) = #sprite then
  [ 14] getprop 1259 ............................ <pBgSprite>
  [ 17] getobjprop 303 .......................... <pBgSprite.spriteNum>
  [ 20] pusharglistnoret 1 ...................... <pBgSprite.spriteNum>
  [ 22] extcall 302 ............................. releaseSprite(pBgSprite.spriteNum)
  [ 25] pusharglist 0 ........................... <>
  [ 27] extcall 118 ............................. <VOID>
  [ 29] setprop 1259 ............................ pBgSprite = VOID
  [ 32] getprop 1260 ............................ <pUserSprite>
  [ 35] pusharglist 1 ........................... <pUserSprite>
  [ 37] extcall 146 ............................. <ilk(pUserSprite)>
  [ 39] pushsymb 300 ............................ <#sprite>
  [ 42] eq ...................................... <ilk(pUserSprite) = #sprite>
  [ 43] jmpifz [ 64] ............................ if ilk(pUserSprite) = #sprite then
  [ 46] getprop 1260 ............................ <pUserSprite>
  [ 49] getobjprop 303 .......................... <pUserSprite.spriteNum>
  [ 52] pusharglistnoret 1 ...................... <pUserSprite.spriteNum>
  [ 54] extcall 302 ............................. releaseSprite(pUserSprite.spriteNum)
  [ 57] pusharglist 0 ........................... <>
  [ 59] extcall 118 ............................. <VOID>
  [ 61] setprop 1260 ............................ pUserSprite = VOID
  [ 64] getprop 1265 ............................ <pBgMemName>
  [ 67] pusharglist 1 ........................... <pBgMemName>
  [ 69] extcall 204 ............................. <memberExists(pBgMemName)>
  [ 71] jmpifz [ 82] ............................ if memberExists(pBgMemName) then
  [ 74] getprop 1265 ............................ <pBgMemName>
  [ 77] pusharglistnoret 1 ...................... <pBgMemName>
  [ 79] extcall 642 ............................. removeMember(pBgMemName)
  [ 82] ret
end

on defineBalloon me, tMode, tColor, tText, tItemID, tSourceLoc
  [  0] pushcons 12 ............................. <"chat_item_background_">
  [  2] getparam 4 .............................. <tItemID>
  [  4] joinstr ................................. <"chat_item_background_" & tItemID>
  [  5] setlocal 0 .............................. tNewBgMemName = "chat_item_background_" & tItemID
  [  7] getlocal 0 .............................. <tNewBgMemName>
  [  9] setprop 1265 ............................ pBgMemName = tNewBgMemName
  [ 12] getprop 1265 ............................ <pBgMemName>
  [ 15] pusharglist 1 ........................... <pBgMemName>
  [ 17] extcall 204 ............................. <memberExists(pBgMemName)>
  [ 19] not ..................................... <not memberExists(pBgMemName)>
  [ 20] jmpifz [ 34] ............................ if not memberExists(pBgMemName) then
  [ 23] getprop 1265 ............................ <pBgMemName>
  [ 26] pushsymb 455 ............................ <#bitmap>
  [ 29] pusharglistnoret 2 ...................... <pBgMemName, #bitmap>
  [ 31] extcall 645 ............................. createMember(pBgMemName, #bitmap)
  [ 34] getparam 4 .............................. <tItemID>
  [ 36] setprop 1258 ............................ pItemId = tItemID
  [ 39] getparam 0 .............................. <me>
  [ 41] getparam 3 .............................. <tText>
  [ 43] getparam 1 .............................. <tMode>
  [ 45] pusharglist 3 ........................... <me, tText, tMode>
  [ 47] objcall 1257 ............................ <me.renderText(tText, tMode)>
  [ 50] setlocal 1 .............................. tTextImg = me.renderText(tText, tMode)
  [ 52] getlocal 1 .............................. <tTextImg>
  [ 54] getobjprop 95 ........................... <tTextImg.width>
  [ 56] setlocal 2 .............................. tTextWidth = tTextImg.width
  [ 58] pushcons 13 ............................. <"icon.respect.thumb">
  [ 60] pusharglist 1 ........................... <"icon.respect.thumb">
  [ 62] extcall 453 ............................. <getMember("icon.respect.thumb")>
  [ 65] getobjprop 175 .......................... <getMember("icon.respect.thumb").image>
  [ 67] setlocal 3 .............................. tUserImg = getMember("icon.respect.thumb").image
  [ 69] getlocal 3 .............................. <tUserImg>
  [ 71] pusharglist 1 ........................... <tUserImg>
  [ 73] extcall 146 ............................. <ilk(tUserImg)>
  [ 75] pushsymb 175 ............................ <#image>
  [ 77] eq ...................................... <ilk(tUserImg) = #image>
  [ 78] jmpifz [ 87] ............................ if ilk(tUserImg) = #image then
  [ 81] getlocal 3 .............................. <tUserImg>
  [ 83] getobjprop 95 ........................... <tUserImg.width>
  [ 85] setlocal 4 .............................. tUserImgWidth = tUserImg.width
  [ 87] getprop 1263 ............................ <pMargins>
  [ 90] pushsymb 1264 ........................... <#textleft>
  [ 93] pusharglist 2 ........................... <pMargins, #textleft>
  [ 95] objcall 75 .............................. <pMargins[#textleft]>
  [ 97] getlocal 2 .............................. <tTextWidth>
  [ 99] add ..................................... <pMargins[#textleft] + tTextWidth>
  [100] getprop 1263 ............................ <pMargins>
  [103] pushsymb 229 ............................ <#right>
  [105] pusharglist 2 ........................... <pMargins, #right>
  [107] objcall 75 .............................. <pMargins[#right]>
  [109] add ..................................... <pMargins[#textleft] + tTextWidth + pMargins[#right]>
  [110] setlocal 5 .............................. tBalloonWidth = pMargins[#textleft] + tTextWidth + pMargins[#right]
  [112] getparam 0 .............................. <me>
  [114] getlocal 5 .............................. <tBalloonWidth>
  [116] getparam 2 .............................. <tColor>
  [118] pusharglist 3 ........................... <me, tBalloonWidth, tColor>
  [120] objcall 1256 ............................ <me.renderBackground(tBalloonWidth, tColor)>
  [123] setlocal 6 .............................. tBackgroundImg = me.renderBackground(tBalloonWidth, tColor)
  [125] getprop 1263 ............................ <pMargins>
  [128] pushsymb 695 ............................ <#left>
  [131] pusharglist 2 ........................... <pMargins, #left>
  [133] objcall 75 .............................. <pMargins[#left]>
  [135] getlocal 4 .............................. <tUserImgWidth>
  [137] add ..................................... <pMargins[#left] + tUserImgWidth>
  [138] getprop 1263 ............................ <pMargins>
  [141] pushsymb 1276 ........................... <#separator>
  [144] pusharglist 2 ........................... <pMargins, #separator>
  [146] objcall 75 .............................. <pMargins[#separator]>
  [148] add ..................................... <pMargins[#left] + tUserImgWidth + pMargins[#separator]>
  [149] setlocal 7 .............................. tTextOffH = pMargins[#left] + tUserImgWidth + pMargins[#separator]
  [151] getprop 1263 ............................ <pMargins>
  [154] pushsymb 1264 ........................... <#textleft>
  [157] pusharglist 2 ........................... <pMargins, #textleft>
  [159] objcall 75 .............................. <pMargins[#textleft]>
  [161] setlocal 7 .............................. tTextOffH = pMargins[#textleft]
  [163] getprop 1269 ............................ <pBalloonImg>
  [166] pushsymb 1271 ........................... <#middle>
  [169] pusharglist 2 ........................... <pBalloonImg, #middle>
  [171] objcall 75 .............................. <pBalloonImg[#middle]>
  [173] getobjprop 97 ........................... <pBalloonImg[#middle].height>
  [175] getlocal 1 .............................. <tTextImg>
  [177] getobjprop 97 ........................... <tTextImg.height>
  [179] sub ..................................... <pBalloonImg[#middle].height - tTextImg.height>
  [180] pushint8 2 .............................. <2>
  [182] div ..................................... <(pBalloonImg[#middle].height - tTextImg.height) / 2>
  [183] pushint8 1 .............................. <1>
  [185] add ..................................... <((pBalloonImg[#middle].height - tTextImg.height) / 2) + 1>
  [186] setlocal 8 .............................. tTextOffV = ((pBalloonImg[#middle].height - tTextImg.height) / 2) + 1
  [188] getlocal 7 .............................. <tTextOffH>
  [190] getlocal 8 .............................. <tTextOffV>
  [192] getlocal 7 .............................. <tTextOffH>
  [194] getlocal 2 .............................. <tTextWidth>
  [196] add ..................................... <tTextOffH + tTextWidth>
  [197] getlocal 8 .............................. <tTextOffV>
  [199] getlocal 1 .............................. <tTextImg>
  [201] getobjprop 97 ........................... <tTextImg.height>
  [203] add ..................................... <tTextOffV + tTextImg.height>
  [204] pusharglist 4 ........................... <tTextOffH, tTextOffV, tTextOffH + tTextWidth, tTextOffV + tTextImg.height>
  [206] extcall 39 .............................. <rect(tTextOffH, tTextOffV, tTextOffH + tTextWidth, tTextOffV + tTextImg.height)>
  [208] setlocal 9 .............................. tTextDestRect = rect(tTextOffH, tTextOffV, tTextOffH + tTextWidth, tTextOffV + tTextImg.height)
  [210] getlocal 6 .............................. <tBackgroundImg>
  [212] getlocal 1 .............................. <tTextImg>
  [214] getlocal 9 .............................. <tTextDestRect>
  [216] getlocal 1 .............................. <tTextImg>
  [218] getobjprop 39 ........................... <tTextImg.rect>
  [220] pusharglistnoret 4 ...................... <tBackgroundImg, tTextImg, tTextDestRect, tTextImg.rect>
  [222] objcall 209 ............................. tBackgroundImg.copyPixels(tTextImg, tTextDestRect, tTextImg.rect)
  [224] getprop 1265 ............................ <pBgMemName>
  [227] pusharglist 1 ........................... <pBgMemName>
  [229] extcall 453 ............................. <getMember(pBgMemName)>
  [232] setlocal 10 ............................. tBgMem = getMember(pBgMemName)
  [234] getlocal 10 ............................. <tBgMem>
  [236] getlocal 6 .............................. <tBackgroundImg>
  [238] setobjprop 175 .......................... tBgMem.image = tBackgroundImg
  [240] getlocal 10 ............................. <tBgMem>
  [242] pushzero ................................ <0>
  [243] pushzero ................................ <0>
  [244] pusharglist 2 ........................... <0, 0>
  [246] extcall 330 ............................. <point(0, 0)>
  [249] setobjprop 899 .......................... tBgMem.regPoint = point(0, 0)
  [252] pushcons 13 ............................. <"icon.respect.thumb">
  [254] pusharglist 1 ........................... <"icon.respect.thumb">
  [256] extcall 453 ............................. <getMember("icon.respect.thumb")>
  [259] setlocal 11 ............................. tUserMem = getMember("icon.respect.thumb")
  [261] getlocal 11 ............................. <tUserMem>
  [263] pushzero ................................ <0>
  [264] pushzero ................................ <0>
  [265] pusharglist 2 ........................... <0, 0>
  [267] extcall 330 ............................. <point(0, 0)>
  [270] setobjprop 899 .......................... tUserMem.regPoint = point(0, 0)
  [273] getprop 1259 ............................ <pBgSprite>
  [276] getlocal 10 ............................. <tBgMem>
  [278] setobjprop 134 .......................... pBgSprite.member = tBgMem
  [280] getprop 1260 ............................ <pUserSprite>
  [283] getlocal 11 ............................. <tUserMem>
  [285] setobjprop 134 .......................... pUserSprite.member = tUserMem
  [287] getprop 1259 ............................ <pBgSprite>
  [290] pushint8 8 .............................. <8>
  [292] setobjprop 196 .......................... pBgSprite.ink = 8
  [294] getprop 1260 ............................ <pUserSprite>
  [297] pushint8 8 .............................. <8>
  [299] setobjprop 196 .......................... pUserSprite.ink = 8
  [301] getparam 5 .............................. <tSourceLoc>
  [303] pusharglist 1 ........................... <tSourceLoc>
  [305] extcall 54 .............................. <voidp(tSourceLoc)>
  [307] not ..................................... <not voidp(tSourceLoc)>
  [308] jmpifz [322] ............................ if not voidp(tSourceLoc) then
  [311] getparam 0 .............................. <me>
  [313] getparam 5 .............................. <tSourceLoc>
  [315] pusharglist 2 ........................... <me, tSourceLoc>
  [317] objcall 1222 ............................ <me.setLocation(tSourceLoc)>
  [320] setlocal 12 ............................. tloc = me.setLocation(tSourceLoc)
  [322] getprop 1259 ............................ <pBgSprite>
  [325] getobjprop 303 .......................... <pBgSprite.spriteNum>
  [328] getparam 0 .............................. <me>
  [330] pusharglist 1 ........................... <me>
  [332] objcall 89 .............................. <me.getID()>
  [334] pusharglistnoret 2 ...................... <pBgSprite.spriteNum, me.getID()>
  [336] extcall 854 ............................. setEventBroker(pBgSprite.spriteNum, me.getID())
  [339] getprop 1259 ............................ <pBgSprite>
  [342] pushsymb 1254 ........................... <#eventProcUserSelect>
  [345] getparam 0 .............................. <me>
  [347] pusharglist 1 ........................... <me>
  [349] objcall 89 .............................. <me.getID()>
  [351] pushsymb 860 ............................ <#mouseDown>
  [354] pusharglistnoret 4 ...................... <pBgSprite, #eventProcUserSelect, me.getID(), #mouseDown>
  [356] objcall 91 .............................. pBgSprite.registerProcedure(#eventProcUserSelect, me.getID(), #mouseDown)
  [358] pushint8 1 .............................. <1>
  [360] pusharglistnoret 1 ...................... <1>
  [362] extcall 50 .............................. return 1
  [364] ret
end

on showBalloon me, tVisible
  [  0] getparam 1 .............................. <tVisible>
  [  2] pusharglist 1 ........................... <tVisible>
  [  4] extcall 54 .............................. <voidp(tVisible)>
  [  6] jmpifz [ 13] ............................ if voidp(tVisible) then
  [  9] pushint8 1 .............................. <1>
  [ 11] setparam 1 .............................. tVisible = 1
  [ 13] getprop 1259 ............................ <pBgSprite>
  [ 16] pusharglist 1 ........................... <pBgSprite>
  [ 18] extcall 146 ............................. <ilk(pBgSprite)>
  [ 20] pushsymb 300 ............................ <#sprite>
  [ 23] eq ...................................... <ilk(pBgSprite) = #sprite>
  [ 24] jmpifz [ 34] ............................ if ilk(pBgSprite) = #sprite then
  [ 27] getprop 1259 ............................ <pBgSprite>
  [ 30] getparam 1 .............................. <tVisible>
  [ 32] setobjprop 106 .......................... pBgSprite.visible = tVisible
  [ 34] getprop 1260 ............................ <pUserSprite>
  [ 37] pusharglist 1 ........................... <pUserSprite>
  [ 39] extcall 146 ............................. <ilk(pUserSprite)>
  [ 41] pushsymb 300 ............................ <#sprite>
  [ 44] eq ...................................... <ilk(pUserSprite) = #sprite>
  [ 45] jmpifz [ 55] ............................ if ilk(pUserSprite) = #sprite then
  [ 48] getprop 1260 ............................ <pUserSprite>
  [ 51] getparam 1 .............................. <tVisible>
  [ 53] setobjprop 106 .......................... pUserSprite.visible = tVisible
  [ 55] ret
end

on moveVerticallyBy me, tMoveAmount
  [  0] getprop 1289 ............................ <pLocation>
  [  3] pushzero ................................ <0>
  [  4] getparam 1 .............................. <tMoveAmount>
  [  6] pusharglist 2 ........................... <0, tMoveAmount>
  [  8] extcall 330 ............................. <point(0, tMoveAmount)>
  [ 11] add ..................................... <pLocation + point(0, tMoveAmount)>
  [ 12] setlocal 0 .............................. tNewLocation = pLocation + point(0, tMoveAmount)
  [ 14] getparam 0 .............................. <me>
  [ 16] getlocal 0 .............................. <tNewLocation>
  [ 18] pusharglistnoret 2 ...................... <me, tNewLocation>
  [ 20] objcall 1222 ............................ me.setLocation(tNewLocation)
  [ 23] getlocal 0 .............................. <tNewLocation>
  [ 25] pushint8 2 .............................. <2>
  [ 27] pusharglist 2 ........................... <tNewLocation, 2>
  [ 29] objcall 75 .............................. <tNewLocation[2]>
  [ 31] pusharglistnoret 1 ...................... <tNewLocation[2]>
  [ 33] extcall 50 .............................. return tNewLocation[2]
  [ 35] ret
end

on setLocation me, tloc
  [  0] getparam 1 .............................. <tloc>
  [  2] pusharglist 1 ........................... <tloc>
  [  4] extcall 146 ............................. <ilk(tloc)>
  [  6] pushsymb 330 ............................ <#point>
  [  9] nteq .................................... <ilk(tloc) <> #point>
  [ 10] getparam 1 .............................. <tloc>
  [ 12] pusharglist 1 ........................... <tloc>
  [ 14] extcall 146 ............................. <ilk(tloc)>
  [ 16] pushsymb 519 ............................ <#list>
  [ 19] nteq .................................... <ilk(tloc) <> #list>
  [ 20] and ..................................... <(ilk(tloc) <> #point) and (ilk(tloc) <> #list)>
  [ 21] jmpifz [ 29] ............................ if (ilk(tloc) <> #point) and (ilk(tloc) <> #list) then
  [ 24] pushzero ................................ <0>
  [ 25] pusharglistnoret 1 ...................... <0>
  [ 27] extcall 50 .............................. return 0
  [ 29] getprop 1265 ............................ <pBgMemName>
  [ 32] pusharglist 1 ........................... <pBgMemName>
  [ 34] extcall 453 ............................. <getMember(pBgMemName)>
  [ 37] setlocal 0 .............................. tMem = getMember(pBgMemName)
  [ 39] getlocal 0 .............................. <tMem>
  [ 41] getobjprop 454 .......................... <tMem.type>
  [ 44] pushsymb 455 ............................ <#bitmap>
  [ 47] eq ...................................... <tMem.type = #bitmap>
  [ 48] jmpifz [ 62] ............................ if tMem.type = #bitmap then / else
  [ 51] getlocal 0 .............................. <tMem>
  [ 53] getchainedprop 175 ...................... <tMem.image>
  [ 55] getobjprop 95 ........................... <tMem.image.width>
  [ 57] setlocal 1 .............................. tMemWidth = tMem.image.width
  [ 59] jmp [ 67]
  [ 62] pushzero ................................ <0>
  [ 63] pusharglistnoret 1 ...................... <0>
  [ 65] extcall 50 .............................. return 0
  [ 67] getparam 1 .............................. <tloc>
  [ 69] pushint8 1 .............................. <1>
  [ 71] pusharglist 2 ........................... <tloc, 1>
  [ 73] objcall 75 .............................. <tloc[1]>
  [ 75] getlocal 1 .............................. <tMemWidth>
  [ 77] pushint8 2 .............................. <2>
  [ 79] div ..................................... <tMemWidth / 2>
  [ 80] sub ..................................... <tloc[1] - (tMemWidth / 2)>
  [ 81] setlocal 2 .............................. tRelativeLocH = tloc[1] - (tMemWidth / 2)
  [ 83] getlocal 2 .............................. <tRelativeLocH>
  [ 85] getprop 1273 ............................ <pBalloonLeftMarg>
  [ 88] pusharglist 2 ........................... <tRelativeLocH, pBalloonLeftMarg>
  [ 90] extcall 240 ............................. <max(tRelativeLocH, pBalloonLeftMarg)>
  [ 92] setlocal 2 .............................. tRelativeLocH = max(tRelativeLocH, pBalloonLeftMarg)
  [ 94] getlocal 2 .............................. <tRelativeLocH>
  [ 96] getprop 1274 ............................ <pBalloonRightMarg>
  [ 99] getprop 1259 ............................ <pBgSprite>
  [102] getchainedprop 134 ...................... <pBgSprite.member>
  [104] getchainedprop 175 ...................... <pBgSprite.member.image>
  [106] getobjprop 95 ........................... <pBgSprite.member.image.width>
  [108] sub ..................................... <pBalloonRightMarg - pBgSprite.member.image.width>
  [109] pusharglist 2 ........................... <tRelativeLocH, pBalloonRightMarg - pBgSprite.member.image.width>
  [111] extcall 1292 ............................ <min(tRelativeLocH, pBalloonRightMarg - pBgSprite.member.image.width)>
  [114] setlocal 2 .............................. tRelativeLocH = min(tRelativeLocH, pBalloonRightMarg - pBgSprite.member.image.width)
  [116] getparam 1 .............................. <tloc>
  [118] setprop 1289 ............................ pLocation = tloc
  [121] getprop 1259 ............................ <pBgSprite>
  [124] getlocal 2 .............................. <tRelativeLocH>
  [126] getprop 1289 ............................ <pLocation>
  [129] pushint8 2 .............................. <2>
  [131] pusharglist 2 ........................... <pLocation, 2>
  [133] objcall 75 .............................. <pLocation[2]>
  [135] pusharglist 2 ........................... <tRelativeLocH, pLocation[2]>
  [137] extcall 330 ............................. <point(tRelativeLocH, pLocation[2])>
  [140] setobjprop 306 .......................... pBgSprite.loc = point(tRelativeLocH, pLocation[2])
  [143] getprop 1260 ............................ <pUserSprite>
  [146] getchainedprop 134 ...................... <pUserSprite.member>
  [148] getchainedprop 175 ...................... <pUserSprite.member.image>
  [150] getobjprop 97 ........................... <pUserSprite.member.image.height>
  [152] getprop 1269 ............................ <pBalloonImg>
  [155] pushsymb 1271 ........................... <#middle>
  [158] pusharglist 2 ........................... <pBalloonImg, #middle>
  [160] objcall 75 .............................. <pBalloonImg[#middle]>
  [162] getobjprop 97 ........................... <pBalloonImg[#middle].height>
  [164] sub ..................................... <pUserSprite.member.image.height - pBalloonImg[#middle].height>
  [165] pushint8 2 .............................. <2>
  [167] div ..................................... <(pUserSprite.member.image.height - pBalloonImg[#middle].height) / 2>
  [168] setlocal 3 .............................. tUserSprOffV = (pUserSprite.member.image.height - pBalloonImg[#middle].height) / 2
  [170] getprop 1269 ............................ <pBalloonImg>
  [173] pushsymb 695 ............................ <#left>
  [176] pusharglist 2 ........................... <pBalloonImg, #left>
  [178] objcall 75 .............................. <pBalloonImg[#left]>
  [180] getobjprop 95 ........................... <pBalloonImg[#left].width>
  [182] getprop 1260 ............................ <pUserSprite>
  [185] getchainedprop 134 ...................... <pUserSprite.member>
  [187] getchainedprop 175 ...................... <pUserSprite.member.image>
  [189] getobjprop 95 ........................... <pUserSprite.member.image.width>
  [191] sub ..................................... <pBalloonImg[#left].width - pUserSprite.member.image.width>
  [192] pushint8 2 .............................. <2>
  [194] div ..................................... <(pBalloonImg[#left].width - pUserSprite.member.image.width) / 2>
  [195] pushint8 1 .............................. <1>
  [197] add ..................................... <((pBalloonImg[#left].width - pUserSprite.member.image.width) / 2) + 1>
  [198] setlocal 4 .............................. tUserOffH = ((pBalloonImg[#left].width - pUserSprite.member.image.width) / 2) + 1
  [200] getprop 1260 ............................ <pUserSprite>
  [203] getlocal 4 .............................. <tUserOffH>
  [205] getlocal 2 .............................. <tRelativeLocH>
  [207] add ..................................... <tUserOffH + tRelativeLocH>
  [208] getprop 1289 ............................ <pLocation>
  [211] pushint8 2 .............................. <2>
  [213] pusharglist 2 ........................... <pLocation, 2>
  [215] objcall 75 .............................. <pLocation[2]>
  [217] pushint8 1 .............................. <1>
  [219] inv ..................................... <-1>
  [220] getlocal 3 .............................. <tUserSprOffV>
  [222] mul ..................................... <-1 * tUserSprOffV>
  [223] add ..................................... <pLocation[2] + (-1 * tUserSprOffV)>
  [224] pusharglist 2 ........................... <tUserOffH + tRelativeLocH, pLocation[2] + (-1 * tUserSprOffV)>
  [226] extcall 330 ............................. <point(tUserOffH + tRelativeLocH, pLocation[2] + (-1 * tUserSprOffV))>
  [229] setobjprop 306 .......................... pUserSprite.loc = point(tUserOffH + tRelativeLocH, pLocation[2] + (-1 * tUserSprOffV))
  [232] getprop 1259 ............................ <pBgSprite>
  [235] pushcons 14 ............................. <"window.default.locz">
  [237] pusharglist 1 ........................... <"window.default.locz">
  [239] extcall 326 ............................. <getIntVariable("window.default.locz")>
  [242] pushint16 2000 .......................... <2000>
  [245] sub ..................................... <getIntVariable("window.default.locz") - 2000>
  [246] getprop 1289 ............................ <pLocation>
  [249] pushint8 2 .............................. <2>
  [251] pusharglist 2 ........................... <pLocation, 2>
  [253] objcall 75 .............................. <pLocation[2]>
  [255] pushint8 10 ............................. <10>
  [257] div ..................................... <pLocation[2] / 10>
  [258] add ..................................... <getIntVariable("window.default.locz") - 2000 + (pLocation[2] / 10)>
  [259] setobjprop 308 .......................... pBgSprite.locZ = getIntVariable("window.default.locz") - 2000 + (pLocation[2] / 10)
  [262] getprop 1260 ............................ <pUserSprite>
  [265] getprop 1259 ............................ <pBgSprite>
  [268] getobjprop 308 .......................... <pBgSprite.locZ>
  [271] pushint8 100 ............................ <100>
  [273] add ..................................... <pBgSprite.locZ + 100>
  [274] setobjprop 308 .......................... pUserSprite.locZ = pBgSprite.locZ + 100
  [277] getlocal 2 .............................. <tRelativeLocH>
  [279] getprop 1289 ............................ <pLocation>
  [282] pushint8 2 .............................. <2>
  [284] pusharglist 2 ........................... <pLocation, 2>
  [286] objcall 75 .............................. <pLocation[2]>
  [288] pusharglist 2 ........................... <tRelativeLocH, pLocation[2]>
  [290] extcall 330 ............................. <point(tRelativeLocH, pLocation[2])>
  [293] pusharglistnoret 1 ...................... <point(tRelativeLocH, pLocation[2])>
  [295] extcall 50 .............................. return point(tRelativeLocH, pLocation[2])
  [297] ret
end

on getLowPoint me
  [  0] getprop 1289 ............................ <pLocation>
  [  3] pushint8 2 .............................. <2>
  [  5] pusharglist 2 ........................... <pLocation, 2>
  [  7] objcall 75 .............................. <pLocation[2]>
  [  9] pusharglistnoret 1 ...................... <pLocation[2]>
  [ 11] extcall 50 .............................. return pLocation[2]
  [ 13] ret
end

on getItemId me
  [  0] getprop 1258 ............................ <pItemId>
  [  3] pusharglistnoret 1 ...................... <pItemId>
  [  5] extcall 50 .............................. return pItemId
  [  7] ret
end

on getType me
  [  0] pushcons 1 .............................. <"CUSTOM">
  [  2] pusharglistnoret 1 ...................... <"CUSTOM">
  [  4] extcall 50 .............................. return "CUSTOM"
  [  6] ret
end

on renderBackground me, tWidth, tBalloonColor
  [  0] getparam 2 .............................. <tBalloonColor>
  [  2] getobjprop 1303 ......................... <tBalloonColor.red>
  [  5] getparam 2 .............................. <tBalloonColor>
  [  7] getobjprop 1304 ......................... <tBalloonColor.green>
  [ 10] add ..................................... <tBalloonColor.red + tBalloonColor.green>
  [ 11] getparam 2 .............................. <tBalloonColor>
  [ 13] getobjprop 1305 ......................... <tBalloonColor.blue>
  [ 16] add ..................................... <tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue>
  [ 17] pushint16 600 ........................... <600>
  [ 20] gteq .................................... <(tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue) >= 600>
  [ 21] jmpifz [ 76] ............................ if (tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue) >= 600 then
  [ 24] pushzero ................................ <0>
  [ 25] pushzero ................................ <0>
  [ 26] pushzero ................................ <0>
  [ 27] pusharglist 3 ........................... <0, 0, 0>
  [ 29] extcall 141 ............................. <rgb(0, 0, 0)>
  [ 31] setlocal 0 .............................. tBalloonColorDarken = rgb(0, 0, 0)
  [ 33] getlocal 0 .............................. <tBalloonColorDarken>
  [ 35] getparam 2 .............................. <tBalloonColor>
  [ 37] getobjprop 1303 ......................... <tBalloonColor.red>
  [ 40] pushcons 15 ............................. <0.90000000000000002>
  [ 42] mul ..................................... <tBalloonColor.red * 0.90000000000000002>
  [ 43] setobjprop 1303 ......................... tBalloonColorDarken.red = tBalloonColor.red * 0.90000000000000002
  [ 46] getlocal 0 .............................. <tBalloonColorDarken>
  [ 48] getparam 2 .............................. <tBalloonColor>
  [ 50] getobjprop 1304 ......................... <tBalloonColor.green>
  [ 53] pushcons 15 ............................. <0.90000000000000002>
  [ 55] mul ..................................... <tBalloonColor.green * 0.90000000000000002>
  [ 56] setobjprop 1304 ......................... tBalloonColorDarken.green = tBalloonColor.green * 0.90000000000000002
  [ 59] getlocal 0 .............................. <tBalloonColorDarken>
  [ 61] getparam 2 .............................. <tBalloonColor>
  [ 63] getobjprop 1305 ......................... <tBalloonColor.blue>
  [ 66] pushcons 15 ............................. <0.90000000000000002>
  [ 68] mul ..................................... <tBalloonColor.blue * 0.90000000000000002>
  [ 69] setobjprop 1305 ......................... tBalloonColorDarken.blue = tBalloonColor.blue * 0.90000000000000002
  [ 72] getlocal 0 .............................. <tBalloonColorDarken>
  [ 74] setparam 2 .............................. tBalloonColor = tBalloonColorDarken
  [ 76] getparam 2 .............................. <tBalloonColor>
  [ 78] getobjprop 1303 ......................... <tBalloonColor.red>
  [ 81] getparam 2 .............................. <tBalloonColor>
  [ 83] getobjprop 1304 ......................... <tBalloonColor.green>
  [ 86] add ..................................... <tBalloonColor.red + tBalloonColor.green>
  [ 87] getparam 2 .............................. <tBalloonColor>
  [ 89] getobjprop 1305 ......................... <tBalloonColor.blue>
  [ 92] add ..................................... <tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue>
  [ 93] pushint8 100 ............................ <100>
  [ 95] lteq .................................... <(tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue) <= 100>
  [ 96] jmpifz [151] ............................ if (tBalloonColor.red + tBalloonColor.green + tBalloonColor.blue) <= 100 then
  [ 99] pushzero ................................ <0>
  [100] pushzero ................................ <0>
  [101] pushzero ................................ <0>
  [102] pusharglist 3 ........................... <0, 0, 0>
  [104] extcall 141 ............................. <rgb(0, 0, 0)>
  [106] setlocal 0 .............................. tBalloonColorDarken = rgb(0, 0, 0)
  [108] getlocal 0 .............................. <tBalloonColorDarken>
  [110] getparam 2 .............................. <tBalloonColor>
  [112] getobjprop 1303 ......................... <tBalloonColor.red>
  [115] pushint8 3 .............................. <3>
  [117] mul ..................................... <tBalloonColor.red * 3>
  [118] setobjprop 1303 ......................... tBalloonColorDarken.red = tBalloonColor.red * 3
  [121] getlocal 0 .............................. <tBalloonColorDarken>
  [123] getparam 2 .............................. <tBalloonColor>
  [125] getobjprop 1304 ......................... <tBalloonColor.green>
  [128] pushint8 3 .............................. <3>
  [130] mul ..................................... <tBalloonColor.green * 3>
  [131] setobjprop 1304 ......................... tBalloonColorDarken.green = tBalloonColor.green * 3
  [134] getlocal 0 .............................. <tBalloonColorDarken>
  [136] getparam 2 .............................. <tBalloonColor>
  [138] getobjprop 1305 ......................... <tBalloonColor.blue>
  [141] pushint8 3 .............................. <3>
  [143] mul ..................................... <tBalloonColor.blue * 3>
  [144] setobjprop 1305 ......................... tBalloonColorDarken.blue = tBalloonColor.blue * 3
  [147] getlocal 0 .............................. <tBalloonColorDarken>
  [149] setparam 2 .............................. tBalloonColor = tBalloonColorDarken
  [151] getparam 1 .............................. <tWidth>
  [153] getprop 1269 ............................ <pBalloonImg>
  [156] pushsymb 695 ............................ <#left>
  [159] pusharglist 2 ........................... <pBalloonImg, #left>
  [161] objcall 75 .............................. <pBalloonImg[#left]>
  [163] getobjprop 97 ........................... <pBalloonImg[#left].height>
  [165] getprop 1269 ............................ <pBalloonImg>
  [168] pushsymb 1272 ........................... <#pointer>
  [171] pusharglist 2 ........................... <pBalloonImg, #pointer>
  [173] objcall 75 .............................. <pBalloonImg[#pointer]>
  [175] getobjprop 97 ........................... <pBalloonImg[#pointer].height>
  [177] add ..................................... <pBalloonImg[#left].height + pBalloonImg[#pointer].height>
  [178] pushint8 32 ............................. <32>
  [180] pusharglist 3 ........................... <tWidth, pBalloonImg[#left].height + pBalloonImg[#pointer].height, 32>
  [182] extcall 175 ............................. <image(tWidth, pBalloonImg[#left].height + pBalloonImg[#pointer].height, 32)>
  [184] setlocal 1 .............................. tNewImg = image(tWidth, pBalloonImg[#left].height + pBalloonImg[#pointer].height, 32)
  [186] pushzero ................................ <0>
  [187] setlocal 2 .............................. tStartPointY = 0
  [189] getprop 1269 ............................ <pBalloonImg>
  [192] pushsymb 695 ............................ <#left>
  [195] pusharglist 2 ........................... <pBalloonImg, #left>
  [197] objcall 75 .............................. <pBalloonImg[#left]>
  [199] getobjprop 97 ........................... <pBalloonImg[#left].height>
  [201] setlocal 3 .............................. tEndPointY = pBalloonImg[#left].height
  [203] pushzero ................................ <0>
  [204] setlocal 4 .............................. tStartPointX = 0
  [206] pushzero ................................ <0>
  [207] setlocal 5 .............................. tEndPointX = 0
  [209] pushsymb 695 ............................ <#left>
  [212] pushsymb 1270 ........................... <#leftcolor>
  [215] pushsymb 1271 ........................... <#middle>
  [218] pushsymb 229 ............................ <#right>
  [220] pusharglist 4 ........................... <[#left, #leftcolor, #middle, #right]>
  [222] pushlist ................................ <[#left, #leftcolor, #middle, #right]>
  [223] peek 0
  [225] pusharglist 1
  [227] extcall 105
  [229] pushint8 1
  [231] peek 0
  [233] peek 2
  [235] lteq
  [236] jmpifz [613] ............................ repeat with i in [#left, #leftcolor, #middle, #right]
  [239] peek 2
  [241] peek 1
  [243] pusharglist 2
  [245] extcall 75
  [247] setlocal 6
  [249] getlocal 5 .............................. <tEndPointX>
  [251] setlocal 4 .............................. tStartPointX = tEndPointX
  [253] getlocal 6 .............................. <i>
  [255] peek 0 .................................. case i of
  [257] pushsymb 695 ............................ <#left>
  [260] eq
  [261] jmpifz [329] ............................ (case) #left:
  [264] getlocal 5 .............................. <tEndPointX>
  [266] getprop 1269 ............................ <pBalloonImg>
  [269] getlocal 6 .............................. <i>
  [271] pusharglist 2 ........................... <pBalloonImg, i>
  [273] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [275] getobjprop 95 ........................... <pBalloonImg.getProp(i).width>
  [277] add ..................................... <tEndPointX + pBalloonImg.getProp(i).width>
  [278] setlocal 5 .............................. tEndPointX = tEndPointX + pBalloonImg.getProp(i).width
  [280] getlocal 4 .............................. <tStartPointX>
  [282] getlocal 2 .............................. <tStartPointY>
  [284] getlocal 5 .............................. <tEndPointX>
  [286] getlocal 3 .............................. <tEndPointY>
  [288] pusharglist 4 ........................... <tStartPointX, tStartPointY, tEndPointX, tEndPointY>
  [290] extcall 39 .............................. <rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)>
  [292] setlocal 7 .............................. tdestrect = rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)
  [294] getlocal 1 .............................. <tNewImg>
  [296] getprop 1269 ............................ <pBalloonImg>
  [299] getlocal 6 .............................. <i>
  [301] pusharglist 2 ........................... <pBalloonImg, i>
  [303] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [305] getlocal 7 .............................. <tdestrect>
  [307] getprop 1269 ............................ <pBalloonImg>
  [310] getlocal 6 .............................. <i>
  [312] pusharglist 2 ........................... <pBalloonImg, i>
  [314] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [316] getobjprop 39 ........................... <pBalloonImg.getProp(i).rect>
  [318] pusharglistnoret 4 ...................... <tNewImg, pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect>
  [320] objcall 209 ............................. tNewImg.copyPixels(pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect)
  [322] pushint8 1 .............................. <1>
  [324] setlocal 5 .............................. tEndPointX = 1
  [326] jmp [605]
  [329] peek 0
  [331] pushsymb 1270 ........................... <#leftcolor>
  [334] eq
  [335] jmpifz [453] ............................ (case) #leftcolor:
  [338] getlocal 5 .............................. <tEndPointX>
  [340] getprop 1269 ............................ <pBalloonImg>
  [343] getlocal 6 .............................. <i>
  [345] pusharglist 2 ........................... <pBalloonImg, i>
  [347] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [349] getobjprop 95 ........................... <pBalloonImg.getProp(i).width>
  [351] add ..................................... <tEndPointX + pBalloonImg.getProp(i).width>
  [352] setlocal 5 .............................. tEndPointX = tEndPointX + pBalloonImg.getProp(i).width
  [354] getlocal 4 .............................. <tStartPointX>
  [356] getlocal 2 .............................. <tStartPointY>
  [358] getlocal 5 .............................. <tEndPointX>
  [360] getlocal 2 .............................. <tStartPointY>
  [362] getprop 1269 ............................ <pBalloonImg>
  [365] getlocal 6 .............................. <i>
  [367] pusharglist 2 ........................... <pBalloonImg, i>
  [369] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [371] getobjprop 97 ........................... <pBalloonImg.getProp(i).height>
  [373] add ..................................... <tStartPointY + pBalloonImg.getProp(i).height>
  [374] pusharglist 4 ........................... <tStartPointX, tStartPointY, tEndPointX, tStartPointY + pBalloonImg.getProp(i).height>
  [376] extcall 39 .............................. <rect(tStartPointX, tStartPointY, tEndPointX, tStartPointY + pBalloonImg.getProp(i).height)>
  [378] pushzero ................................ <0>
  [379] pushint8 1 .............................. <1>
  [381] pushzero ................................ <0>
  [382] pushint8 1 .............................. <1>
  [384] pusharglist 4 ........................... <0, 1, 0, 1>
  [386] extcall 39 .............................. <rect(0, 1, 0, 1)>
  [388] add ..................................... <rect(tStartPointX, tStartPointY, tEndPointX, tStartPointY + pBalloonImg.getProp(i).height) + rect(0, 1, 0, 1)>
  [389] setlocal 7 .............................. tdestrect = rect(tStartPointX, tStartPointY, tEndPointX, tStartPointY + pBalloonImg.getProp(i).height) + rect(0, 1, 0, 1)
  [391] getprop 1269 ............................ <pBalloonImg>
  [394] getlocal 6 .............................. <i>
  [396] pusharglist 2 ........................... <pBalloonImg, i>
  [398] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [400] pusharglist 1 ........................... <pBalloonImg.getProp(i)>
  [402] objcall 208 ............................. <pBalloonImg.getProp(i).createMatte()>
  [404] setlocal 8 .............................. tMatte = pBalloonImg.getProp(i).createMatte()
  [406] getlocal 1 .............................. <tNewImg>
  [408] getprop 1269 ............................ <pBalloonImg>
  [411] getlocal 6 .............................. <i>
  [413] pusharglist 2 ........................... <pBalloonImg, i>
  [415] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [417] getlocal 7 .............................. <tdestrect>
  [419] getprop 1269 ............................ <pBalloonImg>
  [422] getlocal 6 .............................. <i>
  [424] pusharglist 2 ........................... <pBalloonImg, i>
  [426] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [428] getobjprop 39 ........................... <pBalloonImg.getProp(i).rect>
  [430] pushsymb 858 ............................ <#bgColor>
  [433] getparam 2 .............................. <tBalloonColor>
  [435] pushsymb 196 ............................ <#ink>
  [437] pushint8 41 ............................. <41>
  [439] pushsymb 207 ............................ <#maskImage>
  [441] getlocal 8 .............................. <tMatte>
  [443] pusharglist 6 ........................... <[#bgColor: tBalloonColor, #ink: 41, #maskImage: tMatte]>
  [445] pushproplist ............................ <[#bgColor: tBalloonColor, #ink: 41, #maskImage: tMatte]>
  [446] pusharglistnoret 5 ...................... <tNewImg, pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect, [#bgColor: tBalloonColor, #ink: 41, #maskImage: tMatte]>
  [448] objcall 209 ............................. tNewImg.copyPixels(pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect, [#bgColor: tBalloonColor, #ink: 41, #maskImage: tMatte])
  [450] jmp [605]
  [453] peek 0
  [455] pushsymb 1271 ........................... <#middle>
  [458] eq
  [459] jmpifz [539] ............................ (case) #middle:
  [462] getlocal 5 .............................. <tEndPointX>
  [464] getparam 1 .............................. <tWidth>
  [466] add ..................................... <tEndPointX + tWidth>
  [467] getprop 1269 ............................ <pBalloonImg>
  [470] pushsymb 695 ............................ <#left>
  [473] pusharglist 2 ........................... <pBalloonImg, #left>
  [475] objcall 199 ............................. <pBalloonImg.getProp(#left)>
  [477] getobjprop 95 ........................... <pBalloonImg.getProp(#left).width>
  [479] sub ..................................... <tEndPointX + tWidth - pBalloonImg.getProp(#left).width>
  [480] getprop 1269 ............................ <pBalloonImg>
  [483] pushsymb 229 ............................ <#right>
  [485] pusharglist 2 ........................... <pBalloonImg, #right>
  [487] objcall 199 ............................. <pBalloonImg.getProp(#right)>
  [489] getobjprop 95 ........................... <pBalloonImg.getProp(#right).width>
  [491] sub ..................................... <tEndPointX + tWidth - pBalloonImg.getProp(#left).width - pBalloonImg.getProp(#right).width>
  [492] setlocal 5 .............................. tEndPointX = tEndPointX + tWidth - pBalloonImg.getProp(#left).width - pBalloonImg.getProp(#right).width
  [494] getlocal 4 .............................. <tStartPointX>
  [496] getlocal 2 .............................. <tStartPointY>
  [498] getlocal 5 .............................. <tEndPointX>
  [500] getlocal 3 .............................. <tEndPointY>
  [502] pusharglist 4 ........................... <tStartPointX, tStartPointY, tEndPointX, tEndPointY>
  [504] extcall 39 .............................. <rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)>
  [506] setlocal 7 .............................. tdestrect = rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)
  [508] getlocal 1 .............................. <tNewImg>
  [510] getprop 1269 ............................ <pBalloonImg>
  [513] getlocal 6 .............................. <i>
  [515] pusharglist 2 ........................... <pBalloonImg, i>
  [517] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [519] getlocal 7 .............................. <tdestrect>
  [521] getprop 1269 ............................ <pBalloonImg>
  [524] getlocal 6 .............................. <i>
  [526] pusharglist 2 ........................... <pBalloonImg, i>
  [528] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [530] getobjprop 39 ........................... <pBalloonImg.getProp(i).rect>
  [532] pusharglistnoret 4 ...................... <tNewImg, pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect>
  [534] objcall 209 ............................. tNewImg.copyPixels(pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect)
  [536] jmp [605]
  [539] peek 0
  [541] pushsymb 229 ............................ <#right>
  [543] eq
  [544] jmpifz [605] ............................ (case) #right:
  [547] getlocal 5 .............................. <tEndPointX>
  [549] getprop 1269 ............................ <pBalloonImg>
  [552] getlocal 6 .............................. <i>
  [554] pusharglist 2 ........................... <pBalloonImg, i>
  [556] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [558] getobjprop 95 ........................... <pBalloonImg.getProp(i).width>
  [560] add ..................................... <tEndPointX + pBalloonImg.getProp(i).width>
  [561] setlocal 5 .............................. tEndPointX = tEndPointX + pBalloonImg.getProp(i).width
  [563] getlocal 4 .............................. <tStartPointX>
  [565] getlocal 2 .............................. <tStartPointY>
  [567] getlocal 5 .............................. <tEndPointX>
  [569] getlocal 3 .............................. <tEndPointY>
  [571] pusharglist 4 ........................... <tStartPointX, tStartPointY, tEndPointX, tEndPointY>
  [573] extcall 39 .............................. <rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)>
  [575] setlocal 7 .............................. tdestrect = rect(tStartPointX, tStartPointY, tEndPointX, tEndPointY)
  [577] getlocal 1 .............................. <tNewImg>
  [579] getprop 1269 ............................ <pBalloonImg>
  [582] getlocal 6 .............................. <i>
  [584] pusharglist 2 ........................... <pBalloonImg, i>
  [586] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [588] getlocal 7 .............................. <tdestrect>
  [590] getprop 1269 ............................ <pBalloonImg>
  [593] getlocal 6 .............................. <i>
  [595] pusharglist 2 ........................... <pBalloonImg, i>
  [597] objcall 199 ............................. <pBalloonImg.getProp(i)>
  [599] getobjprop 39 ........................... <pBalloonImg.getProp(i).rect>
  [601] pusharglistnoret 4 ...................... <tNewImg, pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect>
  [603] objcall 209 ............................. tNewImg.copyPixels(pBalloonImg.getProp(i), tdestrect, pBalloonImg.getProp(i).rect)
  [605] pop 1 ................................... end case
  [607] pushint8 1
  [609] add
  [610] endrepeat [231]
  [613] pop 3
  [615] getlocal 1 .............................. <tNewImg>
  [617] pusharglistnoret 1 ...................... <tNewImg>
  [619] extcall 50 .............................. return tNewImg
  [621] ret
end

on renderText me, tChatMessage, tChatMode
  [  0] getprop 1268 ............................ <pTextParams>
  [  3] getparam 2 .............................. <tChatMode>
  [  5] pusharglist 2 ........................... <pTextParams, tChatMode>
  [  7] objcall 75 .............................. <pTextParams[tChatMode]>
  [  9] setlocal 0 .............................. tTextParams = pTextParams[tChatMode]
  [ 11] getlocal 0 .............................. <tTextParams>
  [ 13] pushsymb 134 ............................ <#member>
  [ 15] pusharglist 2 ........................... <tTextParams, #member>
  [ 17] objcall 75 .............................. <tTextParams[#member]>
  [ 19] setlocal 1 .............................. tmember = tTextParams[#member]
  [ 21] getparam 1 .............................. <tChatMessage>
  [ 23] setlocal 2 .............................. tText = tChatMessage
  [ 25] getlocal 1 .............................. <tmember>
  [ 27] getlocal 2 .............................. <tText>
  [ 29] setobjprop 646 .......................... tmember.text = tText
  [ 32] getlocal 1 .............................. <tmember>
  [ 34] getlocal 0 .............................. <tTextParams>
  [ 36] pushsymb 651 ............................ <#font>
  [ 39] pusharglist 2 ........................... <tTextParams, #font>
  [ 41] objcall 75 .............................. <tTextParams[#font]>
  [ 43] setobjprop 651 .......................... tmember.font = tTextParams[#font]
  [ 46] getlocal 1 .............................. <tmember>
  [ 48] getlocal 0 .............................. <tTextParams>
  [ 50] pushsymb 653 ............................ <#fontStyle>
  [ 53] pusharglist 2 ........................... <tTextParams, #fontStyle>
  [ 55] objcall 75 .............................. <tTextParams[#fontStyle]>
  [ 57] setobjprop 653 .......................... tmember.fontStyle = tTextParams[#fontStyle]
  [ 60] getlocal 1 .............................. <tmember>
  [ 62] getlocal 1 .............................. <tmember>
  [ 64] pushsymb 197 ............................ <#char>
  [ 66] pusharglist 2 ........................... <tmember, #char>
  [ 68] objcall 105 ............................. <tmember.char.count>
  [ 70] pusharglist 2 ........................... <tmember, tmember.char.count>
  [ 72] objcall 654 ............................. <tmember.charPosToLoc(tmember.char.count)>
  [ 75] getobjprop 307 .......................... <tmember.charPosToLoc(tmember.char.count).locH>
  [ 78] getprop 1269 ............................ <pBalloonImg>
  [ 81] pushsymb 229 ............................ <#right>
  [ 83] pusharglist 2 ........................... <pBalloonImg, #right>
  [ 85] objcall 75 .............................. <pBalloonImg[#right]>
  [ 87] getobjprop 95 ........................... <pBalloonImg[#right].width>
  [ 89] add ..................................... <tmember.charPosToLoc(tmember.char.count).locH + pBalloonImg[#right].width>
  [ 90] setlocal 3 .............................. tTextWidth = tmember.charPosToLoc(tmember.char.count).locH + pBalloonImg[#right].width
  [ 92] getlocal 1 .............................. <tmember>
  [ 94] pushzero ................................ <0>
  [ 95] pushzero ................................ <0>
  [ 96] getlocal 3 .............................. <tTextWidth>
  [ 98] getlocal 1 .............................. <tmember>
  [100] getobjprop 97 ........................... <tmember.height>
  [102] pusharglist 4 ........................... <0, 0, tTextWidth, tmember.height>
  [104] extcall 39 .............................. <rect(0, 0, tTextWidth, tmember.height)>
  [106] setobjprop 39 ........................... tmember.rect = rect(0, 0, tTextWidth, tmember.height)
  [108] getlocal 1 .............................. <tmember>
  [110] getchainedprop 175 ...................... <tmember.image>
  [112] pusharglist 1 ........................... <tmember.image>
  [114] objcall 176 ............................. <tmember.image.duplicate()>
  [116] setlocal 4 .............................. tTextImg = tmember.image.duplicate()
  [118] getlocal 4 .............................. <tTextImg>
  [120] pusharglistnoret 1 ...................... <tTextImg>
  [122] extcall 50 .............................. return tTextImg
  [124] ret
end

on eventProcUserSelect me, tEvent, tSprID
  [  0] getprop 320 ............................. <pUserId>
  [  3] pushcons 0 .............................. <EMPTY>
  [  5] nteq .................................... <pUserId <> EMPTY>
  [  6] jmpifz [ 33] ............................ if pUserId <> EMPTY then
  [  9] pushsymb 77 ............................. <#room>
  [ 11] pusharglist 1 ........................... <#room>
  [ 13] extcall 76 .............................. <getThread(#room)>
  [ 15] pusharglist 1 ........................... <getThread(#room)>
  [ 17] objcall 78 .............................. <getThread(#room).getInterface()>
  [ 19] setlocal 0 .............................. tRoomInterface = getThread(#room).getInterface()
  [ 21] getlocal 0 .............................. <tRoomInterface>
  [ 23] getparam 1 .............................. <tEvent>
  [ 25] getprop 320 ............................. <pUserId>
  [ 28] pusharglistnoret 3 ...................... <tRoomInterface, tEvent, pUserId>
  [ 30] objcall 526 ............................. tRoomInterface.eventProcUserObj(tEvent, pUserId)
  [ 33] ret
end
