property pDirection, pDefOffset, pCurOffset, pActOffset, pHitOffset, pBalOffList, pAnimFrm, pAction, pimage

on define me, tPart, tProps
  [  0] getparam 2 .............................. <tProps>
  [  2] pushsymb 102 ............................ <#dir>
  [  4] pusharglist 2 ........................... <tProps, #dir>
  [  6] objcall 54 .............................. <tProps[#dir]>
  [  8] pushint8 4 .............................. <4>
  [ 10] eq ...................................... <tProps[#dir] = 4>
  [ 11] jmpifz [ 33] ............................ if tProps[#dir] = 4 then / else
  [ 14] pushint8 3 .............................. <3>
  [ 16] setprop 167 ............................. pDirection = 3
  [ 18] pushint8 1 .............................. <1>
  [ 20] pushzero ................................ <0>
  [ 21] pushint8 1 .............................. <1>
  [ 23] pushzero ................................ <0>
  [ 24] pusharglist 4 ........................... <1, 0, 1, 0>
  [ 26] extcall 219 ............................. <rect(1, 0, 1, 0)>
  [ 28] setprop 236 ............................. pDefOffset = rect(1, 0, 1, 0)
  [ 30] jmp [ 53]
  [ 33] pushint8 7 .............................. <7>
  [ 35] setprop 167 ............................. pDirection = 7
  [ 37] pushint8 7 .............................. <7>
  [ 39] inv ..................................... <-7>
  [ 40] pushint8 1 .............................. <1>
  [ 42] pushint8 7 .............................. <7>
  [ 44] inv ..................................... <-7>
  [ 45] pushint8 1 .............................. <1>
  [ 47] pusharglist 4 ........................... <-7, 1, -7, 1>
  [ 49] extcall 219 ............................. <rect(-7, 1, -7, 1)>
  [ 51] setprop 236 ............................. pDefOffset = rect(-7, 1, -7, 1)
  [ 53] pushzero ................................ <0>
  [ 54] pushzero ................................ <0>
  [ 55] pushzero ................................ <0>
  [ 56] pushzero ................................ <0>
  [ 57] pusharglist 4 ........................... <[0, 0, 0, 0]>
  [ 59] pushlist ................................ <[0, 0, 0, 0]>
  [ 60] setprop 237 ............................. pActOffset = [0, 0, 0, 0]
  [ 62] pushzero ................................ <0>
  [ 63] pushzero ................................ <0>
  [ 64] pushzero ................................ <0>
  [ 65] pushzero ................................ <0>
  [ 66] pusharglist 4 ........................... <0, 0, 0, 0>
  [ 68] extcall 219 ............................. <rect(0, 0, 0, 0)>
  [ 70] setprop 238 ............................. pCurOffset = rect(0, 0, 0, 0)
  [ 72] pushint8 4 .............................. <4>
  [ 74] inv ..................................... <-4>
  [ 75] pushint8 2 .............................. <2>
  [ 77] pushint8 4 .............................. <4>
  [ 79] inv ..................................... <-4>
  [ 80] pushint8 2 .............................. <2>
  [ 82] pusharglist 4 ........................... <[-4, 2, -4, 2]>
  [ 84] pushlist ................................ <[-4, 2, -4, 2]>
  [ 85] pushint8 2 .............................. <2>
  [ 87] inv ..................................... <-2>
  [ 88] pushint8 1 .............................. <1>
  [ 90] pushint8 2 .............................. <2>
  [ 92] inv ..................................... <-2>
  [ 93] pushint8 1 .............................. <1>
  [ 95] pusharglist 4 ........................... <[-2, 1, -2, 1]>
  [ 97] pushlist ................................ <[-2, 1, -2, 1]>
  [ 98] pushzero ................................ <0>
  [ 99] pushint8 2 .............................. <2>
  [101] pushint8 1 .............................. <1>
  [103] pushint8 2 .............................. <2>
  [105] pushint8 1 .............................. <1>
  [107] pusharglist 4 ........................... <[2, 1, 2, 1]>
  [109] pushlist ................................ <[2, 1, 2, 1]>
  [110] pushint8 4 .............................. <4>
  [112] pushint8 2 .............................. <2>
  [114] pushint8 4 .............................. <4>
  [116] pushint8 2 .............................. <2>
  [118] pusharglist 4 ........................... <[4, 2, 4, 2]>
  [120] pushlist ................................ <[4, 2, 4, 2]>
  [121] pusharglist 5 ........................... <[[-4, 2, -4, 2], [-2, 1, -2, 1], 0, [2, 1, 2, 1], [4, 2, 4, 2]]>
  [123] pushlist ................................ <[[-4, 2, -4, 2], [-2, 1, -2, 1], 0, [2, 1, 2, 1], [4, 2, 4, 2]]>
  [124] setprop 239 ............................. pBalOffList = [[-4, 2, -4, 2], [-2, 1, -2, 1], 0, [2, 1, 2, 1], [4, 2, 4, 2]]
  [126] getprop 167 ............................. <pDirection>
  [128] pushint8 7 .............................. <7>
  [130] eq ...................................... <pDirection = 7>
  [131] jmpifz [152] ............................ if pDirection = 7 then / else
  [134] pushint8 2 .............................. <2>
  [136] pushint8 1 .............................. <1>
  [138] inv ..................................... <-1>
  [139] pushint8 2 .............................. <2>
  [141] pushint8 1 .............................. <1>
  [143] inv ..................................... <-1>
  [144] pusharglist 4 ........................... <[2, -1, 2, -1]>
  [146] pushlist ................................ <[2, -1, 2, -1]>
  [147] setprop 240 ............................. pHitOffset = [2, -1, 2, -1]
  [149] jmp [167]
  [152] pushint8 2 .............................. <2>
  [154] inv ..................................... <-2>
  [155] pushint8 1 .............................. <1>
  [157] pushint8 2 .............................. <2>
  [159] inv ..................................... <-2>
  [160] pushint8 1 .............................. <1>
  [162] pusharglist 4 ........................... <[-2, 1, -2, 1]>
  [164] pushlist ................................ <[-2, 1, -2, 1]>
  [165] setprop 240 ............................. pHitOffset = [-2, 1, -2, 1]
  [167] getparam 2 .............................. <tProps>
  [169] pushsymb 207 ............................ <#buffer>
  [171] pusharglist 2 ........................... <tProps, #buffer>
  [173] objcall 54 .............................. <tProps[#buffer]>
  [175] pusharglist 1 ........................... <tProps[#buffer]>
  [177] objcall 180 ............................. <tProps[#buffer].duplicate()>
  [179] setprop 241 ............................. pimage = tProps[#buffer].duplicate()
  [181] pushsymb 242 ............................ <#part>
  [183] pushcons 0 .............................. <"hd">
  [185] pushsymb 182 ............................ <#ink>
  [187] pushint8 41 ............................. <41>
  [189] pusharglist 4 ........................... <[#part: "hd", #ink: 41]>
  [191] pushproplist ............................ <[#part: "hd", #ink: 41]>
  [192] pushsymb 242 ............................ <#part>
  [194] pushcons 1 .............................. <"hr">
  [196] pushsymb 182 ............................ <#ink>
  [198] pushint8 41 ............................. <41>
  [200] pusharglist 4 ........................... <[#part: "hr", #ink: 41]>
  [202] pushproplist ............................ <[#part: "hr", #ink: 41]>
  [203] pushsymb 242 ............................ <#part>
  [205] pushcons 2 .............................. <"fc">
  [207] pushsymb 182 ............................ <#ink>
  [209] pushint8 41 ............................. <41>
  [211] pusharglist 4 ........................... <[#part: "fc", #ink: 41]>
  [213] pushproplist ............................ <[#part: "fc", #ink: 41]>
  [214] pusharglist 3 ........................... <[[#part: "hd", #ink: 41], [#part: "hr", #ink: 41], [#part: "fc", #ink: 41]]>
  [216] pushlist ................................ <[[#part: "hd", #ink: 41], [#part: "hr", #ink: 41], [#part: "fc", #ink: 41]]>
  [217] peek 0
  [219] pusharglist 1
  [221] extcall 62
  [223] pushint8 1
  [225] peek 0
  [227] peek 2
  [229] lteq
  [230] jmpifz [461] ............................ repeat with tdata in [[#part: "hd", #ink: 41], [#part: "hr", #ink: 41], [#part: "fc", #ink: 41]]
  [233] peek 2
  [235] peek 1
  [237] pusharglist 2
  [239] extcall 54
  [241] setlocal 0
  [243] getlocal 0 .............................. <tdata>
  [245] pushsymb 242 ............................ <#part>
  [247] pusharglist 2 ........................... <tdata, #part>
  [249] objcall 54 .............................. <tdata[#part]>
  [251] setparam 1 .............................. tPart = tdata[#part]
  [253] getlocal 0 .............................. <tdata>
  [255] pushsymb 182 ............................ <#ink>
  [257] pusharglist 2 ........................... <tdata, #ink>
  [259] objcall 54 .............................. <tdata[#ink]>
  [261] setlocal 1 .............................. tInk = tdata[#ink]
  [263] getparam 2 .............................. <tProps>
  [265] pushsymb 206 ............................ <#figure>
  [267] pusharglist 2 ........................... <tProps, #figure>
  [269] objcall 54 .............................. <tProps[#figure]>
  [271] getparam 1 .............................. <tPart>
  [273] pusharglist 2 ........................... <tProps[#figure], tPart>
  [275] objcall 54 .............................. <tProps[#figure][tPart]>
  [277] setlocal 2 .............................. tFigure = tProps[#figure][tPart]
  [279] pushcons 3 .............................. <"sh_std_">
  [281] getparam 1 .............................. <tPart>
  [283] joinstr ................................. <"sh_std_" & tPart>
  [284] pushcons 4 .............................. <"_">
  [286] joinstr ................................. <"sh_std_" & tPart & "_">
  [287] getlocal 2 .............................. <tFigure>
  [289] pushcons 5 .............................. <"model">
  [291] pusharglist 2 ........................... <tFigure, "model">
  [293] objcall 54 .............................. <tFigure["model"]>
  [295] joinstr ................................. <"sh_std_" & tPart & "_" & tFigure["model"]>
  [296] pushcons 4 .............................. <"_">
  [298] joinstr ................................. <"sh_std_" & tPart & "_" & tFigure["model"] & "_">
  [299] getprop 167 ............................. <pDirection>
  [301] joinstr ................................. <"sh_std_" & tPart & "_" & tFigure["model"] & "_" & pDirection>
  [302] pushcons 6 .............................. <"_0">
  [304] joinstr ................................. <"sh_std_" & tPart & "_" & tFigure["model"] & "_" & pDirection & "_0">
  [305] pusharglist 1 ........................... <"sh_std_" & tPart & "_" & tFigure["model"] & "_" & pDirection & "_0">
  [307] extcall 64 .............................. <getmemnum("sh_std_" & tPart & "_" & tFigure["model"] & "_" & pDirection & "_0")>
  [309] setlocal 3 .............................. tMemNum = getmemnum("sh_std_" & tPart & "_" & tFigure["model"] & "_" & pDirection & "_0")
  [311] getlocal 2 .............................. <tFigure>
  [313] pushcons 7 .............................. <"color">
  [315] pusharglist 2 ........................... <tFigure, "color">
  [317] objcall 54 .............................. <tFigure["color"]>
  [319] setlocal 4 .............................. tColor = tFigure["color"]
  [321] getlocal 3 .............................. <tMemNum>
  [323] pushzero ................................ <0>
  [324] gt ...................................... <tMemNum > 0>
  [325] jmpifz [456] ............................ if tMemNum > 0 then
  [328] getlocal 3 .............................. <tMemNum>
  [330] pusharglist 1 ........................... <tMemNum>
  [332] extcall 37 .............................. <member(tMemNum)>
  [334] setlocal 5 .............................. tmember = member(tMemNum)
  [336] getlocal 5 .............................. <tmember>
  [338] getobjprop 179 .......................... <tmember.image>
  [340] setlocal 6 .............................. tImage = tmember.image
  [342] getlocal 5 .............................. <tmember>
  [344] getobjprop 41 ........................... <tmember.regPoint>
  [346] setlocal 7 .............................. tRegPnt = tmember.regPoint
  [348] getlocal 7 .............................. <tRegPnt>
  [350] pushint8 1 .............................. <1>
  [352] pusharglist 2 ........................... <tRegPnt, 1>
  [354] objcall 54 .............................. <tRegPnt[1]>
  [356] inv ..................................... <-tRegPnt[1]>
  [357] pushint8 6 .............................. <6>
  [359] add ..................................... <-tRegPnt[1] + 6>
  [360] setlocal 8 .............................. tX = -tRegPnt[1] + 6
  [362] getparam 2 .............................. <tProps>
  [364] pushsymb 207 ............................ <#buffer>
  [366] pusharglist 2 ........................... <tProps, #buffer>
  [368] objcall 54 .............................. <tProps[#buffer]>
  [370] getchainedprop 219 ...................... <tProps[#buffer].rect>
  [372] getobjprop 40 ........................... <tProps[#buffer].rect.height>
  [374] getlocal 7 .............................. <tRegPnt>
  [376] pushint8 2 .............................. <2>
  [378] pusharglist 2 ........................... <tRegPnt, 2>
  [380] objcall 54 .............................. <tRegPnt[2]>
  [382] sub ..................................... <tProps[#buffer].rect.height - tRegPnt[2]>
  [383] pushint8 10 ............................. <10>
  [385] sub ..................................... <tProps[#buffer].rect.height - tRegPnt[2] - 10>
  [386] setlocal 9 .............................. tY = tProps[#buffer].rect.height - tRegPnt[2] - 10
  [388] getlocal 8 .............................. <tX>
  [390] getlocal 9 .............................. <tY>
  [392] getlocal 8 .............................. <tX>
  [394] getlocal 6 .............................. <tImage>
  [396] getobjprop 39 ........................... <tImage.width>
  [398] add ..................................... <tX + tImage.width>
  [399] getlocal 9 .............................. <tY>
  [401] getlocal 6 .............................. <tImage>
  [403] getobjprop 40 ........................... <tImage.height>
  [405] add ..................................... <tY + tImage.height>
  [406] pusharglist 4 ........................... <tX, tY, tX + tImage.width, tY + tImage.height>
  [408] extcall 219 ............................. <rect(tX, tY, tX + tImage.width, tY + tImage.height)>
  [410] getprop 236 ............................. <pDefOffset>
  [412] add ..................................... <rect(tX, tY, tX + tImage.width, tY + tImage.height) + pDefOffset>
  [413] setlocal 10 ............................. tDstRect = rect(tX, tY, tX + tImage.width, tY + tImage.height) + pDefOffset
  [415] getlocal 6 .............................. <tImage>
  [417] getobjprop 219 .......................... <tImage.rect>
  [419] setlocal 11 ............................. tSrcRect = tImage.rect
  [421] getlocal 6 .............................. <tImage>
  [423] pusharglist 1 ........................... <tImage>
  [425] objcall 243 ............................. <tImage.createMatte()>
  [427] setlocal 12 ............................. tMaskImg = tImage.createMatte()
  [429] getprop 241 ............................. <pimage>
  [431] getlocal 6 .............................. <tImage>
  [433] getlocal 10 ............................. <tDstRect>
  [435] getlocal 11 ............................. <tSrcRect>
  [437] pushsymb 244 ............................ <#maskImage>
  [439] getlocal 12 ............................. <tMaskImg>
  [441] pushsymb 182 ............................ <#ink>
  [443] getlocal 1 .............................. <tInk>
  [445] pushsymb 245 ............................ <#bgColor>
  [447] getlocal 4 .............................. <tColor>
  [449] pusharglist 6 ........................... <[#maskImage: tMaskImg, #ink: tInk, #bgColor: tColor]>
  [451] pushproplist ............................ <[#maskImage: tMaskImg, #ink: tInk, #bgColor: tColor]>
  [452] pusharglistnoret 5 ...................... <pimage, tImage, tDstRect, tSrcRect, [#maskImage: tMaskImg, #ink: tInk, #bgColor: tColor]>
  [454] objcall 222 ............................. pimage.copyPixels(tImage, tDstRect, tSrcRect, [#maskImage: tMaskImg, #ink: tInk, #bgColor: tColor])
  [456] pushint8 1
  [458] add
  [459] endrepeat [225]
  [461] pop 3
  [463] pushcons 8 .............................. <EMPTY>
  [465] setprop 166 ............................. pAction = EMPTY
  [467] pushzero ................................ <0>
  [468] setprop 246 ............................. pAnimFrm = 0
  [470] pushint8 1 .............................. <1>
  [472] pusharglistnoret 1 ...................... <1>
  [474] extcall 12 .............................. return 1
  [476] ret
end

on status me, tAction, tBalance
  [  0] getparam 1 .............................. <tAction>
  [  2] setprop 166 ............................. pAction = tAction
  [  4] getparam 2 .............................. <tBalance>
  [  6] setlocal 0 .............................. pBalance = tBalance
  [  8] getprop 239 ............................. <pBalOffList>
  [ 10] getlocal 0 .............................. <pBalance>
  [ 12] pushint8 1 .............................. <1>
  [ 14] add ..................................... <pBalance + 1>
  [ 15] pusharglist 2 ........................... <pBalOffList, pBalance + 1>
  [ 17] objcall 54 .............................. <pBalOffList[pBalance + 1]>
  [ 19] setprop 238 ............................. pCurOffset = pBalOffList[pBalance + 1]
  [ 21] pushzero ................................ <0>
  [ 22] setprop 246 ............................. pAnimFrm = 0
  [ 24] ret
end

on prepare me
  [  0] getprop 246 ............................. <pAnimFrm>
  [  2] pushint8 1 .............................. <1>
  [  4] add ..................................... <pAnimFrm + 1>
  [  5] setprop 246 ............................. pAnimFrm = pAnimFrm + 1
  [  7] pushzero ................................ <0>
  [  8] pushzero ................................ <0>
  [  9] pushzero ................................ <0>
  [ 10] pushzero ................................ <0>
  [ 11] pusharglist 4 ........................... <[0, 0, 0, 0]>
  [ 13] pushlist ................................ <[0, 0, 0, 0]>
  [ 14] setprop 237 ............................. pActOffset = [0, 0, 0, 0]
  [ 16] getprop 246 ............................. <pAnimFrm>
  [ 18] pushint8 1 .............................. <1>
  [ 20] eq ...................................... <pAnimFrm = 1>
  [ 21] jmpifz [ 48] ............................ if pAnimFrm = 1 then
  [ 24] getprop 166 ............................. <pAction>
  [ 26] peek 0 .................................. case pAction of
  [ 28] pushcons 9 .............................. <"hit1">
  [ 30] nteq
  [ 31] jmpifz [ 42] ............................ (case) "hit1", ...
  [ 34] peek 0
  [ 36] pushcons 10 ............................. <"hit2">
  [ 38] eq
  [ 39] jmpifz [ 46] ............................ (case) ..., "hit2":
  [ 42] getprop 240 ............................. <pHitOffset>
  [ 44] setprop 237 ............................. pActOffset = pHitOffset
  [ 46] pop 1
  [ 48] ret
end

on render me, tBuffer
  [  0] getparam 1 .............................. <tBuffer>
  [  2] getprop 241 ............................. <pimage>
  [  4] getprop 241 ............................. <pimage>
  [  6] getobjprop 219 .......................... <pimage.rect>
  [  8] getprop 238 ............................. <pCurOffset>
  [ 10] add ..................................... <pimage.rect + pCurOffset>
  [ 11] getprop 237 ............................. <pActOffset>
  [ 13] add ..................................... <pimage.rect + pCurOffset + pActOffset>
  [ 14] getprop 241 ............................. <pimage>
  [ 16] getobjprop 219 .......................... <pimage.rect>
  [ 18] pushsymb 182 ............................ <#ink>
  [ 20] pushint8 36 ............................. <36>
  [ 22] pusharglist 2 ........................... <[#ink: 36]>
  [ 24] pushproplist ............................ <[#ink: 36]>
  [ 25] pusharglistnoret 5 ...................... <tBuffer, pimage, pimage.rect + pCurOffset + pActOffset, pimage.rect, [#ink: 36]>
  [ 27] objcall 222 ............................. tBuffer.copyPixels(pimage, pimage.rect + pCurOffset + pActOffset, pimage.rect, [#ink: 36])
  [ 29] ret
end
